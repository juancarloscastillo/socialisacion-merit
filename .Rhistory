tl.col = "black",
addCoef.col = "black",
diag = TRUE,
family = "A",
number.font = 6,
tl.cex =0.75,
number.cex = 1)
# Matriz de correlación entre variables nivel 2
basecor<- ap_est %>% select(ingresos_esc, ingresos_pc_esc, heterogen_esc, univ_esc)
cormat=cor(basecor, use = "complete.obs")
#save
#png("../output/images/correlacionl2.png",width=600,height=600)
windowsFonts(A = windowsFont("Times New Roman"))
rownames(cormat) <-c(
"A. Ingresos del hogar por escuela",
"B. Ingresos per capita por escuela",
"C. Heterogeneidad socioeconomica escuela",
"D. Porcentaje ed. tericiaria por escuela")
colnames(cormat) <-c("(A)", "(B)","(C)","(D)")
corrplot(
cormat,
method = "color",
type = "upper",
tl.col = "black",
addCoef.col = "black",
diag = TRUE,
family = "A",
number.font = 6,
tl.cex =0.75,
number.cex = 1)
# Matriz de correlación entre ingresos + variables control
basecor<- ap_est %>% select(ingresos_tramos, ingresos, ingresos_pc, ingresos_esc, ingresos_pc_esc, heterogen_esc, educ_madre, educ_padre, educ_ap, univ, univ_esc, libros_hogar_est, libros_hogar_ap, genero_est, genero_ap, pos_pol_est, pos_pol_ap, edad )
cormat=cor(basecor, use = "complete.obs")
#save
#png("../output/images/correlacionl2.png",width=600,height=600)
windowsFonts(A = windowsFont("Times New Roman"))
rownames(cormat) <-c(
"A. Ingresos del hogar en tramos",
"B. Ingresos del hogar",
"C. Ingresos per capita",
"D. Ingresos del hogar por escuela",
"E. Ingresos per capita por escuela",
"F. Heterogeneidad por escuela",
"G. Educación de la madre",
"H. Educación del padre",
"I. Educación del apoderado",
"J. Dummy universitaria apoderado",
"K. Universitaria por escuela",
"L. Libros en el hogar estudiante",
"M. Libros en el hogar apoderado",
"N. Genero estudiante",
"O. Genero apoderado",
"P. Posición política estudiante",
"Q. Posición política apoderado",
"R. Edad apoderado")
colnames(cormat) <-c("(A)","(B)","(C)","(D)", "(E)", "(F)",  "(G)",  "(H)",  "(I)",  "(J)",  "(K)",  "(L)",  "(M)",  "(N)",  "(O)",  "(P)",  "(Q)",  "(R)")
corrplot(
cormat,
method = "color",
type = "upper",
tl.col = "black",
addCoef.col = "black",
diag = TRUE,
family = "A",
number.font = 6,
tl.cex =0.75,
number.cex = 0.5)
# Percepción meritocracia
mmn_p <- lmer(prom_percmer_est ~ 1 + (1|rbd_est), data = ap_est)
# Percepción meritocracia
mml1_p <- lmer(prom_percmer_est ~ 1 + perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_indirect_ln +
sj_direct_factor +
ingresos_tramos_factor +
(1|rbd_est), data = ap_est)
# Percepción meritocracia
mml2_p <- lmer(prom_percmer_est ~ 1 + ingresos_esc +
univ_esc +
heterogen_esc
+ (1|rbd_est), data = ap_est)
# Percepción meritocracia
mml1l2_p <- lmer(prom_percmer_est ~ perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_indirect_ln +
sj_direct_factor +
ingresos_tramos_factor +
ingresos_esc +
univ_esc +
heterogen_esc
+ (1|rbd_est), data = ap_est)
# Percepción meritocracia
mmin1_p <- lmer(prom_percmer_est ~ perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_indirect_ln +
sj_direct_factor +
ingresos_tramos_factor +
ingresos_esc +
univ_esc +
heterogen_esc +
perc_esfuerzo_factor_ap*sj_indirect_ln + # Interacción
region_factor_est +
dependencia_factor_est +
pos_pol_factor_est +
genero_factor_est +
educ_factor_ap +
libros_hogar_factor_est +
recompensa_factor_est +
pos_pol_factor_ap +
genero_factor_ap +
educ_factor_ap +
libros_hogar_factor_ap +
recompensa_factor_ap +
edad +
(1|rbd_est), data = ap_est)
# Percepción meritocracia
mmin2_p <- lmer(prom_percmer_est ~ perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_indirect_ln +
sj_direct_factor +
ingresos_tramos_factor +
ingresos_esc +
univ_esc +
heterogen_esc +
perc_trabajo_duro_factor_ap*sj_indirect_ln + # Interacción
region_factor_est +
dependencia_factor_est +
pos_pol_factor_est +
genero_factor_est +
educ_factor_ap +
libros_hogar_factor_est +
recompensa_factor_est +
pos_pol_factor_ap +
genero_factor_ap +
educ_factor_ap +
libros_hogar_factor_ap +
recompensa_factor_ap +
edad +
(1|rbd_est), data = ap_est)
# Percepción meritocracia
mmin3_p <- lmer(prom_percmer_est ~ perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_indirect_ln +
sj_direct_factor +
ingresos_tramos_factor +
ingresos_esc +
univ_esc +
heterogen_esc +
#perc_esfuerzo_factor_ap*sj_direct_factor + # Interacción
region_factor_est +
dependencia_factor_est +
pos_pol_factor_est +
genero_factor_est +
educ_factor_ap +
libros_hogar_factor_est +
recompensa_factor_est +
pos_pol_factor_ap +
genero_factor_ap +
educ_factor_ap +
libros_hogar_factor_ap +
recompensa_factor_ap +
edad +
(1|rbd_est), data = ap_est)
# Percepción meritocracia
mmin4_p <- lmer(prom_percmer_est ~ perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_indirect_ln +
sj_direct_factor +
ingresos_tramos_factor +
ingresos_esc +
univ_esc +
heterogen_esc +
perc_trabajo_duro_factor_ap*sj_direct_factor + # Interacción
region_factor_est +
dependencia_factor_est +
pos_pol_factor_est +
genero_factor_est +
educ_factor_ap +
libros_hogar_factor_est +
recompensa_factor_est +
pos_pol_factor_ap +
genero_factor_ap +
educ_factor_ap +
libros_hogar_factor_ap +
recompensa_factor_ap +
edad +
(1|rbd_est), data = ap_est)
htmlreg(list(mmn_p, mml1_p, mml2_p, mml1l2_p, mmin1_p, mmin2_p, mmin3_p, mmin4_p), custom.model.names = c("Nulo", "L1", "L2", "L1+L2", "I1", "I2", "I3", "I4"), custom.coef.names = c("Intercepto", "Perc. Esfuerzo Ap.", "Perc.Trabajo duro Ap.", "Sj Indirecto", "Sj Directo", "Ingreso tramos", "Ingresos por escuela", "Ed. Universitaria por escuela", "Heterogeneidad económica por escuela", "Perc. Esfuerzo Ap.*Sj Indirecto", "Perc. Trabajo duro Ap.*Sj Indirecto", "Perc. Esfuerzo. Ap*Sj Directo","Perc. Trabajo duro*Sj Directo", "Región", "Dependencia", "Posición política Est.", "Género Est.", "Ed. Padre", "Ed. Madre", "Libros hogar Est.", "Recompensa Est.", "Posición Política Ap.", "Género Ap.", "Ed. Ap", "Libros hogar Ap.", "Recompensa Ap.", "Edad Ap."),  star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br>" , caption.above = T, caption = "Socialización de la percepción meritocratica")
htmlreg(list(mmn_p, mml1_p, mml2_p, mml1l2_p, mmin1_p, mmin2_p, mmin3_p, mmin4_p), custom.model.names = c("Nulo", "L1", "L2", "L1+L2", "I1", "I2", "I3", "I4"),
#custom.coef.names = c("Intercepto", "Perc. Esfuerzo Ap.", "Perc.Trabajo duro Ap.", "Sj Indirecto", "Sj Directo", "Ingreso tramos", "Ingresos por escuela", "Ed. Universitaria por escuela", "Heterogeneidad económica por escuela", "Perc. Esfuerzo Ap.*Sj Indirecto", "Perc. Trabajo duro Ap.*Sj Indirecto", "Perc. Esfuerzo. Ap*Sj Directo","Perc. Trabajo duro*Sj Directo", "Región", "Dependencia", "Posición política Est.", "Género Est.", "Ed. Padre", "Ed. Madre", "Libros hogar Est.", "Recompensa Est.", "Posición Política Ap.", "Género Ap.", "Ed. Ap", "Libros hogar Ap.", "Recompensa Ap.", "Edad Ap."),
star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br>" , caption.above = T, caption = "Socialización de la percepción meritocratica")
# Plot Likert: perc. esfuerzo apoderados y estudiantes
baselik<- ap_est %>% select(perc_esfuerzo_est,perc_esfuerzo_ap)
# short var labels
items <- c("Percepcion esfuerzo estudiantes", "Percepcion esfuerzo apoderados")
# cambiar orden para la leyenda
labels= c("Muy en desacuerdo", "En desacuerdo", "De acuerdo", "Muy de acuerdo")  ### E
# save
png("../output/images/Plot-lik-esfuerzo.png", width = 750, height = 300)
sjPlot::plot_likert(baselik,
axis.labels   = items,
legend.labels = labels,
legend.pos = "bottom",
#cat.neutral   = , # identifica a indiferentes
geom.colors   = c("#9ECAE1", "#6BAED6", "#4292C6",
"#2171B5"), # colorbrewer2.org
sort.frq      = "neg.asc", # sort descending)
title         = "Percepción de meritocracia Apoderados e hijos",
intercept.line.color = "white", # vertical middle
expand.grid   = F, # no inner margins in plot
show.n        = FALSE, # hide N's in axis labels
grid.range    = 1.8,
geom.size = 0.6, values = "sum.outside")
dev.off()
# Plot Likert: perc. esfuerzo apoderados y estudiantes
baselik<- ap_est %>% select(perc_esfuerzo_est,perc_esfuerzo_ap)
# short var labels
items <- c("Percepcion esfuerzo estudiantes", "Percepcion esfuerzo apoderados")
# cambiar orden para la leyenda
labels= c("Muy en desacuerdo", "En desacuerdo", "De acuerdo", "Muy de acuerdo")  ### E
# save
#png("../output/images/Plot-lik-esfuerzo.png", width = 750, height = 300)
sjPlot::plot_likert(baselik,
axis.labels   = items,
legend.labels = labels,
legend.pos = "bottom",
#cat.neutral   = , # identifica a indiferentes
geom.colors   = c("#9ECAE1", "#6BAED6", "#4292C6",
"#2171B5"), # colorbrewer2.org
sort.frq      = "neg.asc", # sort descending)
title         = "Percepción de meritocracia Apoderados e hijos",
intercept.line.color = "white", # vertical middle
expand.grid   = F, # no inner margins in plot
show.n        = FALSE, # hide N's in axis labels
grid.range    = 1.8,
geom.size = 0.6, values = "sum.outside")
#dev.off()
# Plot Likert: perc. trabajo duro apoderados y estudiantes
baselik<- ap_est %>% select(perc_trabajo_duro_est,perc_trabajo_duro_ap)
# short var labels
items <- c("Percepcion trabajo duro estudiantes", "Percepcion trabajo duro apoderados")
# cambiar orden para la leyenda
labels= c("Nada Importante", "Poco Importante", "Importante", "Muy Importante")  ### E
#save
#png("../output/images/Plot-lik-trabajoduro.png", width = 750, height = 300)
sjPlot::plot_likert(baselik,
axis.labels   = items,
legend.labels = labels,
legend.pos = "bottom",
#cat.neutral   = , # identifica a indiferentes
geom.colors   = c("#9ECAE1", "#6BAED6", "#4292C6",
"#2171B5"), # colorbrewer2.org
sort.frq      = "neg.asc", # sort descending)
title         = "Percepción de meritocracia Apoderados e hijos",
intercept.line.color = "white", # vertical middle
expand.grid   = F, # no inner margins in plot
show.n        = FALSE, # hide N's in axis labels
grid.range    = 1.8,
geom.size = 0.6, values = "sum.outside")
#dev.off()
select(ap_est, sj_indirect_ln, sj_indirect_noln, sj_direct) %>% summarytools::descr()
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
# Cargar librerías
pacman::p_load(dplyr, #Manipulacion de datos
stargazer, #Tablas
sjmisc, # Tablas
summarytools, # Tablas
kableExtra, #Tablas
sjPlot, #Tablas y gráficos
corrplot, # Correlaciones
sessioninfo, #  Información de la sesión de trabajo
ggplot2, # Graficos
sjlabelled, # Etiquetas
ordinal, # Modelos ordinales,
mixor, # Modelos ordinales
lme4, # Modelos mixtos,
lavaan, # CFA
texreg # Tablas modelos
)
# Cargar datos
load(file = "../input/data/ap_est.RData") # Base conjunta
# Orden para modelos ordinales (mixor package)
ap_est_rbd<-ap_est[order(ap_est$rbd_est),]
# Matriz de correlación entre variales principales
basecor<- ap_est %>% select(perc_trabajo_duro_est,perc_trabajo_duro_ap,perc_esfuerzo_est,perc_esfuerzo_ap,prom_percmer_est,prom_percmer_ap,sj_indirect_ln,sj_direct,ingresos_pc_esc)
cormat=cor(basecor, use = "complete.obs")
#save
#png("../output/images/correlacionl1.png",width=600,height=600)
windowsFonts(A = windowsFont("Times New Roman"))
rownames(cormat) <-c(
"A. Trabajo Duro Estudiantes",
"B. Trabajo Duro Apoderados",
"C. Esfuerzo Estudiantes",
"D. Esfuerzo Apoderados",
"E. Prom. Perc. Mer. Estudiantes",
"F. Prom. Perc. Mer. Apoderados",
"G. Sentido justicia in",
"H. Sentido justicia dir",
"I. Ingresos")
colnames(cormat) <-c("(A)", "(B)","(C)","(D)","(E)","(F)", "(G)", "(H)", "(I)")
corrplot(
cormat,
method = "color",
type = "upper",
tl.col = "black",
addCoef.col = "black",
diag = TRUE,
family = "A",
number.font = 6,
tl.cex =0.75,
number.cex = 1)
# Matriz de correlación entre variables nivel 2
basecor<- ap_est %>% select(ingresos_esc, ingresos_pc_esc, heterogen_esc, univ_esc)
cormat=cor(basecor, use = "complete.obs")
#save
#png("../output/images/correlacionl2.png",width=600,height=600)
windowsFonts(A = windowsFont("Times New Roman"))
rownames(cormat) <-c(
"A. Ingresos del hogar por escuela",
"B. Ingresos per capita por escuela",
"C. Heterogeneidad socioeconomica escuela",
"D. Porcentaje ed. tericiaria por escuela")
colnames(cormat) <-c("(A)", "(B)","(C)","(D)")
corrplot(
cormat,
method = "color",
type = "upper",
tl.col = "black",
addCoef.col = "black",
diag = TRUE,
family = "A",
number.font = 6,
tl.cex =0.75,
number.cex = 1)
# Matriz de correlación entre ingresos + variables control
basecor<- ap_est %>% select(ingresos_tramos, ingresos, ingresos_pc, ingresos_esc, ingresos_pc_esc, heterogen_esc, educ_madre, educ_padre, educ_ap, univ, univ_esc, libros_hogar_est, libros_hogar_ap, genero_est, genero_ap, pos_pol_est, pos_pol_ap, edad )
cormat=cor(basecor, use = "complete.obs")
#save
#png("../output/images/correlacionl2.png",width=600,height=600)
windowsFonts(A = windowsFont("Times New Roman"))
rownames(cormat) <-c(
"A. Ingresos del hogar en tramos",
"B. Ingresos del hogar",
"C. Ingresos per capita",
"D. Ingresos del hogar por escuela",
"E. Ingresos per capita por escuela",
"F. Heterogeneidad por escuela",
"G. Educación de la madre",
"H. Educación del padre",
"I. Educación del apoderado",
"J. Dummy universitaria apoderado",
"K. Universitaria por escuela",
"L. Libros en el hogar estudiante",
"M. Libros en el hogar apoderado",
"N. Genero estudiante",
"O. Genero apoderado",
"P. Posición política estudiante",
"Q. Posición política apoderado",
"R. Edad apoderado")
colnames(cormat) <-c("(A)","(B)","(C)","(D)", "(E)", "(F)",  "(G)",  "(H)",  "(I)",  "(J)",  "(K)",  "(L)",  "(M)",  "(N)",  "(O)",  "(P)",  "(Q)",  "(R)")
corrplot(
cormat,
method = "color",
type = "upper",
tl.col = "black",
addCoef.col = "black",
diag = TRUE,
family = "A",
number.font = 6,
tl.cex =0.75,
number.cex = 0.5)
# Percepción meritocracia
mmn_p <- lmer(prom_percmer_est ~ 1 + (1|rbd_est), data = ap_est)
# Percepción meritocracia
mml1_p <- lmer(prom_percmer_est ~ 1 + perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_indirect_ln +
sj_direct_factor +
ingresos_tramos_factor +
(1|rbd_est), data = ap_est)
# Percepción meritocracia
mml2_p <- lmer(prom_percmer_est ~ 1 + ingresos_esc +
univ_esc +
heterogen_esc
+ (1|rbd_est), data = ap_est)
# Percepción meritocracia
mml1l2_p <- lmer(prom_percmer_est ~ perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_indirect_ln +
sj_direct_factor +
ingresos_tramos_factor +
ingresos_esc +
univ_esc +
heterogen_esc
+ (1|rbd_est), data = ap_est)
# Percepción meritocracia
mmin1_p <- lmer(prom_percmer_est ~ perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_indirect_ln +
sj_direct_factor +
ingresos_tramos_factor +
ingresos_esc +
univ_esc +
heterogen_esc +
perc_esfuerzo_factor_ap*sj_indirect_ln + # Interacción
region_factor_est +
dependencia_factor_est +
pos_pol_factor_est +
genero_factor_est +
educ_factor_ap +
libros_hogar_factor_est +
recompensa_factor_est +
pos_pol_factor_ap +
genero_factor_ap +
educ_factor_ap +
libros_hogar_factor_ap +
recompensa_factor_ap +
edad +
(1|rbd_est), data = ap_est)
# Percepción meritocracia
mmin2_p <- lmer(prom_percmer_est ~ perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_indirect_ln +
sj_direct_factor +
ingresos_tramos_factor +
ingresos_esc +
univ_esc +
heterogen_esc +
perc_trabajo_duro_factor_ap*sj_indirect_ln + # Interacción
region_factor_est +
dependencia_factor_est +
pos_pol_factor_est +
genero_factor_est +
educ_factor_ap +
libros_hogar_factor_est +
recompensa_factor_est +
pos_pol_factor_ap +
genero_factor_ap +
educ_factor_ap +
libros_hogar_factor_ap +
recompensa_factor_ap +
edad +
(1|rbd_est), data = ap_est)
# Percepción meritocracia
mmin3_p <- lmer(prom_percmer_est ~ perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_indirect_ln +
sj_direct_factor +
ingresos_tramos_factor +
ingresos_esc +
univ_esc +
heterogen_esc +
#perc_esfuerzo_factor_ap*sj_direct_factor + # Interacción
region_factor_est +
dependencia_factor_est +
pos_pol_factor_est +
genero_factor_est +
educ_factor_ap +
libros_hogar_factor_est +
recompensa_factor_est +
pos_pol_factor_ap +
genero_factor_ap +
educ_factor_ap +
libros_hogar_factor_ap +
recompensa_factor_ap +
edad +
(1|rbd_est), data = ap_est)
# Percepción meritocracia
mmin4_p <- lmer(prom_percmer_est ~ perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_indirect_ln +
sj_direct_factor +
ingresos_tramos_factor +
ingresos_esc +
univ_esc +
heterogen_esc +
perc_trabajo_duro_factor_ap*sj_direct_factor + # Interacción
region_factor_est +
dependencia_factor_est +
pos_pol_factor_est +
genero_factor_est +
educ_factor_ap +
libros_hogar_factor_est +
recompensa_factor_est +
pos_pol_factor_ap +
genero_factor_ap +
educ_factor_ap +
libros_hogar_factor_ap +
recompensa_factor_ap +
edad +
(1|rbd_est), data = ap_est)
htmlreg(list(mmn_p, mml1_p, mml2_p, mml1l2_p, mmin1_p, mmin2_p, mmin3_p, mmin4_p), custom.model.names = c("Nulo", "L1", "L2", "L1+L2", "I1", "I2", "I3", "I4"),
#custom.coef.names = c("Intercepto", "Perc. Esfuerzo Ap.", "Perc.Trabajo duro Ap.", "Sj Indirecto", "Sj Directo", "Ingreso tramos", "Ingresos por escuela", "Ed. Universitaria por escuela", "Heterogeneidad económica por escuela", "Perc. Esfuerzo Ap.*Sj Indirecto", "Perc. Trabajo duro Ap.*Sj Indirecto", "Perc. Esfuerzo. Ap*Sj Directo","Perc. Trabajo duro*Sj Directo", "Región", "Dependencia", "Posición política Est.", "Género Est.", "Ed. Padre", "Ed. Madre", "Libros hogar Est.", "Recompensa Est.", "Posición Política Ap.", "Género Ap.", "Ed. Ap", "Libros hogar Ap.", "Recompensa Ap.", "Edad Ap."),
star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br>" , caption.above = T, caption = "Socialización de la percepción meritocratica")
# Esfuerzo
mml1_e <- clmm(factor(perc_esfuerzo_est) ~ perc_esfuerzo_ap +
perc_trabajo_duro_ap +
sj_indirect_ln +
sj_direct +
ingresos_tramos +
(1|rbd_est), data = ap_est)
# Trabajo duro
mml1_td <- clmm(factor(perc_trabajo_duro_est) ~ perc_esfuerzo_ap +
perc_trabajo_duro_ap +
sj_indirect_ln +
sj_direct +
ingresos_tramos +
(1|rbd_est), data = ap_est)
