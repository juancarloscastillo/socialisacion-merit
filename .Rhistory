quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# # Modelo 4: Justicia en el trato con el profesor + quintiles y pospol
mml1_p_cwc4 <- lmer(prom_percmer_est ~ 1 +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# Modelo 5:  Quintiles y pospol (controles)
mml1_p_cwc5 <- lmer(prom_percmer_est ~ 1 +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# Modelo 6: Variables importantes + quintiles y pospol
mml1_p_cwc6 <- lmer(prom_percmer_est ~ 1 +
prom_percmer_ap_cwc +
sj_direct_cwc + recompensa_est_cwc +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc   + (1|rbd_est), data = basereg)
# Modelo 7: Variables importantes y controles (N1 y N2)
mml1_p_cwc7 <- lmer(prom_percmer_est ~ 1 +
prom_percmer_ap_cwc +
sj_direct_cwc + recompensa_est_cwc +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +
pos_pol_est_cwc +
genero_factor_ap +
genero_factor_est +
libros_hogar_ap_cwc +
dependencia_factor_ap +
(1|rbd_est), data = basereg)
# Modelo 8: Variables importantes, controles (N1 y N2) + Interacción
mml1_p_cwc8 <- lmer(prom_percmer_est ~ 1 +
prom_percmer_ap_cwc +
sj_direct_cwc + recompensa_est_cwc +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +
pos_pol_est_cwc +
genero_factor_ap +
genero_factor_est +
libros_hogar_ap_cwc +
dependencia_factor_ap +
prom_percmer_ap_cwc*sj_direct_cwc +
(1|rbd_est), data = basereg)
# Tabla de modelos
htmlreg(list(mmn_p_cwc,mml1_p_cwc1, mml1_p_cwc2, mml1_p_cwc3,mml1_p_cwc4, mml1_p_cwc5, mml1_p_cwc6, mml1_p_cwc7, mml1_p_cwc8), custom.model.names = c("Nulo","Modelo 1", "Modelo 2", "Modelo 3", "Modelo 4", "Modelo 5", "Modelo 6", "Modelo 7", "Modelo 8")
,omit.coef = "(quintiles_ingresos_pc_factor)|(pos_pol_ap_cwc)|(pos_pol_est_cwc)|(genero_factor_ap)|(libros_hogar_ap_cwc)|(dependencia_factor_ap)"
,custom.note = "$***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> Todos los modelos estan controlados por quintiles de ingresos y posicion politica de los padres"
,custom.coef.names = c("Intercepto", "Percepción meritocratica apoderados", "Sentido de justicia en las notas", "Recompensa justa en la escuela", "Justicia en el trato profesor", "Genero estudiantes|Mujer", "Genero estudiantes| Otro", "Percepción meritocratica apoderados x sentido de justicia en las notas")
)
# Regresiones multiples: comparación de modelos
# Seleccionar variables a utilizar
basereg <- ap_est %>% select(perc_esfuerzo_factor_est,
rbd_est,
perc_esfuerzo_factor_ap,
perc_trabajo_duro_factor_ap,
sj_direct_cwc,
quintiles_ingresos_pc_factor,
recompensa_est_cwc,
resp_prof_cwc,
pos_pol_ap_cwc,
pos_pol_est_cwc,
genero_factor_ap,
genero_factor_est,
libros_hogar_ap_cwc,
dependencia_factor_ap)
# Homogeneizar N para modelos
basereg <- na.omit(basereg)
# Modelo 0: Nulo
mmn_e_cwc <- clmm(perc_esfuerzo_factor_est ~ 1 + (1|rbd_est), data = basereg)
# Modelo 1a: Percepción esfuerzo apoderados + quintiles y pospol
mml1_e_cwc1a <- clmm(perc_esfuerzo_factor_est ~ 1 +
perc_esfuerzo_factor_ap +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +  (1|rbd_est), data = basereg)
# Modelo 1b: Percepción trabajo duro apoderados + quintiles y pospol
mml1_e_cwc1b <- clmm(perc_esfuerzo_factor_est ~ 1 +
perc_trabajo_duro_factor_ap +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +  (1|rbd_est), data = basereg)
# Modelo 2: Sentido de justicia directo + quintiles y pospol
mml1_e_cwc2 <- clmm(perc_esfuerzo_factor_est ~ 1 +
sj_direct_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# Modelo 3: Sensación recompensa estudiante + quintiles y pospol
mml1_e_cwc3 <- clmm(perc_esfuerzo_factor_est ~ 1 +
recompensa_est_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# Modelo 4: Justicia en el trato profesores + quintiles y pospol
mml1_e_cwc4 <- clmm(perc_esfuerzo_factor_est ~ 1 +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# Modelo 5: Quintiles y pospol (controles)
mml1_e_cwc5 <- clmm(perc_esfuerzo_factor_est ~ 1 +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# Modelo 6: Variables principales + quintiles y pospol
mml1_e_cwc6 <- clmm(perc_esfuerzo_factor_est ~ 1 +
perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_direct_cwc + recompensa_est_cwc +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc   + (1|rbd_est), data = basereg)
# Modelo 7: Variables principales y controles
mml1_e_cwc7 <- clmm(perc_esfuerzo_factor_est ~ 1 +
perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_direct_cwc + recompensa_est_cwc +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +
pos_pol_est_cwc +
genero_factor_ap +
genero_factor_est +
libros_hogar_ap_cwc +
dependencia_factor_ap +
(1|rbd_est), data = basereg)
# Modelo 8a: Variables principales y controles + Interacción
mml1_e_cwc8a <- clmm(perc_esfuerzo_factor_est ~ 1 +
perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_direct_cwc + recompensa_est_cwc +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +
pos_pol_est_cwc +
genero_factor_ap +
genero_factor_est +
libros_hogar_ap_cwc +
dependencia_factor_ap +
perc_esfuerzo_factor_ap*sj_direct_cwc +
(1|rbd_est), data = basereg)
# Modelo 8b: Variables principales y controles + Interacción
mml1_e_cwc8b <- clmm(perc_esfuerzo_factor_est ~ 1 +
perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_direct_cwc + recompensa_est_cwc +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +
pos_pol_est_cwc +
genero_factor_ap +
genero_factor_est +
libros_hogar_ap_cwc +
dependencia_factor_ap +
perc_trabajo_duro_factor_ap*sj_direct_cwc +
(1|rbd_est), data = basereg)
# Tabla de modelos
htmlreg(list(mmn_e_cwc,mml1_e_cwc1a,mml1_e_cwc1b, mml1_e_cwc2, mml1_e_cwc3,mml1_e_cwc4, mml1_e_cwc5, mml1_e_cwc6, mml1_e_cwc7,mml1_e_cwc8a, mml1_e_cwc8b), custom.model.names = c("Nulo", "Modelo 1a", "Modelo 1b", "Modelo 2", "Modelo 3", "Modelo 4", "Modelo 5", "Modelo 6", "Modelo 7", "Modelo 8a", "Modelo 8b"),
#omit.coef = "(quintiles_ingresos_pc_factor)|(pos_pol_ap_cwc)|(pos_pol_est_cwc)|(genero_factor_ap)|(libros_hogar_ap_cwc)|(dependencia_factor_ap)",
custom.note = "$***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> Todos los modelos estan controlados por quintiles de ingresos y posicion politica de los padres",
custom.coef.names = c("Muy en desacuerdo|En desacuerdo", "En desacuerdo|De acuerdo", "De acuerdo|Muy de acuerdo","Percepcion Esfuerzo Ap|En desacuerdo", "Percepcion Esfuerzo Ap|De acuerdo", "Percepcion Esfuerzo Ap|Muy de acuerdo", "Ingresos PC|Quintil 2", "Ingresos PC|Quintil 3", "Ingresos PC|Quintil 4", "Ingresos PC|Quintil 5", "Ingresos PC|Ns/Nr", "Posicion politica apoderados", "Percepcion Trabajo Duro Ap|Algo importante", "Percepcion Trabajo Duro Ap|Importante", "Percepcion Trabajo Duro Ap|Muy importante", "Sentido de justicia en las notas", "Recompensa justa estudiantes", "Justicia en el trato profesores", "Posicion politica estudiantes", "Genero apoderados|Mujer", "Genero apoderados|Otro", "Genero estudiantes|Mujer", "Genero estudiantes|Otro", "Libros en el hogar", "Dependencia administrativa|Part. Subvencionado", "Dependencia administrativa|Part. Privado", "Percepcion esfuerzo Ap| En desacuerdo x Sentido justicia notas", "Percepcion esfuerzo Ap| De acuerdo x Sentido justicia notas", "Percepcion esfuerzo Ap| Muy de acuerdo x Sentido justicia notas", "Percepcion trabajo duro Ap|Algo importante x Sentido justicia notas", "Percepcion trabajo duro Ap|Importante x Sentido justicia notas", "Percepcion trabajo duro Ap|Muy importante x Sentido justicia notas")
)
# Regresiones múltiples: comparación de modelos
# Seleccionar variables a utilizar
basereg <- ap_est %>% select(perc_trabajo_duro_factor_est,
rbd_est,
perc_esfuerzo_factor_ap,
perc_trabajo_duro_factor_ap,
sj_direct_cwc,
quintiles_ingresos_pc_factor,
recompensa_est_cwc,
resp_prof_cwc,
pos_pol_ap_cwc,
pos_pol_est_cwc,
genero_factor_ap,
genero_factor_est,
libros_hogar_ap_cwc,
dependencia_factor_ap)
# Homogeneizar N para modelos
basereg <- na.omit(basereg)
# Modelo 0: Nulo
mmn_e_cwc <- clmm(perc_trabajo_duro_factor_est ~ 1 + (1|rbd_est), data = basereg)
# Modelo 1a: Percepción esfuerzo apoderados + quintiles y pospol
mml1_td_cwc1a <- clmm(perc_trabajo_duro_factor_est ~ 1 +
perc_esfuerzo_factor_ap +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +  (1|rbd_est), data = basereg)
# Modelo 1b: Percepción trabajo duro apoderados + quintiles y pospol
mml1_td_cwc1b <- clmm(perc_trabajo_duro_factor_est ~ 1 +
perc_trabajo_duro_factor_ap +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +  (1|rbd_est), data = basereg)
# Modelo 2: Sentido de justicia en las notas directo CWC + quintiles y pospol
mml1_td_cwc2 <- clmm(perc_trabajo_duro_factor_est ~ 1 +
sj_direct_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# Modelo 3: Sensación de recompensa en la escuela estudiantes CWC + quintiles y pospol
mml1_td_cwc3 <- clmm(perc_trabajo_duro_factor_est ~ 1 +
recompensa_est_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# Modelo 4: Justicia en el trato profesor + quintiles y pospol
mml1_td_cwc4 <- clmm(perc_trabajo_duro_factor_est ~ 1 +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# Modelo 5: Quinties y pospol (controles)
mml1_td_cwc5 <- clmm(perc_trabajo_duro_factor_est ~ 1 +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# Modelo 6: Variables principales + quintiles y pospol
mml1_td_cwc6 <- clmm(perc_trabajo_duro_factor_est ~ 1 +
perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_direct_cwc + recompensa_est_cwc +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc   + (1|rbd_est), data = basereg)
# Modelo 7: Variables principales y controles
mml1_td_cwc7 <- clmm(perc_trabajo_duro_factor_est ~ 1 +
perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_direct_cwc + recompensa_est_cwc +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +
pos_pol_est_cwc +
genero_factor_ap +
genero_factor_est +
libros_hogar_ap_cwc +
dependencia_factor_ap +
(1|rbd_est), data = basereg)
# Modelo 8a: Variables principales y controles + Interacción A
mml1_td_cwc8a <- clmm(perc_trabajo_duro_factor_est ~ 1 +
perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_direct_cwc + recompensa_est_cwc +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +
pos_pol_est_cwc +
genero_factor_ap +
genero_factor_est +
libros_hogar_ap_cwc +
dependencia_factor_ap +
perc_esfuerzo_factor_ap*sj_direct_cwc +
(1|rbd_est), data = basereg)
# Modelo 8b: Variables principales y controles + Interacción b
mml1_td_cwc8b <- clmm(perc_trabajo_duro_factor_est ~ 1 +
perc_esfuerzo_factor_ap +
perc_trabajo_duro_factor_ap +
sj_direct_cwc + recompensa_est_cwc +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +
pos_pol_est_cwc +
genero_factor_ap +
genero_factor_est +
libros_hogar_ap_cwc +
dependencia_factor_ap +
perc_trabajo_duro_factor_ap*sj_direct_cwc +
(1|rbd_est), data = basereg)
# Tablas de modelos
htmlreg(list(mmn_td_cwc,mml1_td_cwc1a,mml1_td_cwc1b, mml1_td_cwc2, mml1_td_cwc3,mml1_td_cwc4, mml1_td_cwc5, mml1_td_cwc6, mml1_td_cwc7, mml1_td_cwc8a, mml1_td_cwc8b), custom.model.names = c("Nulo", "Modelo 1a", "Modelo 1b", "Modelo 2", "Modelo 3", "Modelo 4", "Modelo 5", "Modelo 6", "Modelo 7", "Modelo 8a", "Modelo 8b")
#,omit.coef = "(quintiles_ingresos_pc_factor)|(pos_pol_ap_cwc)|(pos_pol_est_cwc)|(genero_factor_ap)|(libros_hogar_ap_cwc)|(dependencia_factor_ap)", custom.note = "$***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> Todos los modelos estan controlados por quintiles de ingresos y posicion politica de los padres"
,custom.coef.names = c("Nada importante|Algo importante", "Algo importante|Importante", "Importante|Muy importante",
"Percepcion Esfuerzo Ap|En desacuerdo", "Percepcion Esfuerzo Ap|De acuerdo", "Percepcion Esfuerzo Ap|Muy de acuerdo", "Ingresos PC|Quintil 2", "Ingresos PC|Quintil 3", "Ingresos PC|Quintil 4", "Ingresos PC|Quintil 5", "Ingresos PC|Ns/Nr", "Posicion politica apoderados", "Percepcion Trabajo Duro Ap|Algo importante", "Percepcion Trabajo Duro Ap|Importante", "Percepcion Trabajo Duro Ap|Muy importante", "Sentido de justicia en las notas", "Recompensa justa estudiantes", "Justicia en el trato profesores", "Posicion politica estudiantes", "Genero apoderados|Mujer", "Genero apoderados|Otro", "Genero estudiantes|Mujer", "Genero estudiantes|Otro", "Libros en el hogar", "Dependencia administrativa|Part. Subvencionado", "Dependencia administrativa|Part. Privado", "Percepcion esfuerzo Ap| En desacuerdo x Sentido justicia notas", "Percepcion esfuerzo Ap| De acuerdo x Sentido justicia notas", "Percepcion esfuerzo Ap| Muy de acuerdo x Sentido justicia notas", "Percepcion trabajo duro Ap|Algo importante x Sentido justicia notas", "Percepcion trabajo duro Ap|Importante x Sentido justicia notas", "Percepcion trabajo duro Ap|Muy importante x Sentido justicia notas")
)
# Regresiones multiples: comparación de modelos.
# Seleccionar variables a utilizar
basereg <- ap_est %>% select(prom_percmer_est,
rbd_est,
prom_percmer_ap_cwc,
sj_direct_cwc,
quintiles_ingresos_pc_factor,
recompensa_est_cwc,
resp_prof_cwc,
pos_pol_ap_cwc,
pos_pol_est_cwc,
genero_factor_ap,
genero_factor_est,
libros_hogar_ap_cwc,
dependencia_factor_ap)
# Homogeneizar N para comparación demodelos
basereg <- na.omit(basereg)
# Modelo 0: Nulo
mmn_p_cwc <- lmer(prom_percmer_est ~ 1 + (1|rbd_est), data = basereg)
# Modelo 1: Promedio percepción meritocrática CWC + quintiles y pospol
mml1_p_cwc1 <- lmer(prom_percmer_est ~ 1 +
prom_percmer_ap_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +  (1|rbd_est), data = basereg)
# Modelo 2: Sentido de justicia en las notas directo CWC + quintiles y pospol
mml1_p_cwc2 <- lmer(prom_percmer_est ~ 1 +
sj_direct_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# Modelo 3: Sensación de recompensa estudiante CWC  + quintiles y pospol
mml1_p_cwc3 <- lmer(prom_percmer_est ~ 1 +
recompensa_est_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# # Modelo 4: Justicia en el trato con el profesor + quintiles y pospol
mml1_p_cwc4 <- lmer(prom_percmer_est ~ 1 +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# Modelo 5:  Quintiles y pospol (controles)
mml1_p_cwc5 <- lmer(prom_percmer_est ~ 1 +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc + (1|rbd_est), data = basereg)
# Modelo 6: Variables importantes + quintiles y pospol
mml1_p_cwc6 <- lmer(prom_percmer_est ~ 1 +
prom_percmer_ap_cwc +
sj_direct_cwc + recompensa_est_cwc +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc   + (1|rbd_est), data = basereg)
# Modelo 7: Variables importantes y controles (N1 y N2)
mml1_p_cwc7 <- lmer(prom_percmer_est ~ 1 +
prom_percmer_ap_cwc +
sj_direct_cwc + recompensa_est_cwc +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +
pos_pol_est_cwc +
genero_factor_ap +
genero_factor_est +
libros_hogar_ap_cwc +
dependencia_factor_ap +
(1|rbd_est), data = basereg)
# Modelo 8: Variables importantes, controles (N1 y N2) + Interacción
mml1_p_cwc8 <- lmer(prom_percmer_est ~ 1 +
prom_percmer_ap_cwc +
sj_direct_cwc + recompensa_est_cwc +
resp_prof_cwc +
quintiles_ingresos_pc_factor +
pos_pol_ap_cwc +
pos_pol_est_cwc +
genero_factor_ap +
genero_factor_est +
libros_hogar_ap_cwc +
dependencia_factor_ap +
prom_percmer_ap_cwc*sj_direct_cwc +
(1|rbd_est), data = basereg)
# Tabla de modelos
htmlreg(list(mmn_p_cwc,mml1_p_cwc1, mml1_p_cwc2, mml1_p_cwc3,mml1_p_cwc4, mml1_p_cwc5, mml1_p_cwc6, mml1_p_cwc7, mml1_p_cwc8), custom.model.names = c("Nulo","Modelo 1", "Modelo 2", "Modelo 3", "Modelo 4", "Modelo 5", "Modelo 6", "Modelo 7", "Modelo 8"), star.symbol = "\\*", center = T , caption.above = T, caption = "Var. Dep.: Promedio Percepción percepción meritocratica estudiantes",
omit.coef = "(quintiles_ingresos_pc_factor)|(pos_pol_ap_cwc)|(pos_pol_est_cwc)|(genero_factor_ap)|(libros_hogar_ap_cwc)|(dependencia_factor_ap)"
,custom.note = "$***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> Todos los modelos estan controlados por quintiles de ingresos y posicion politica de los padres"
,custom.coef.names = c("Intercepto", "Percepción meritocratica apoderados", "Sentido de justicia en las notas", "Recompensa justa en la escuela", "Justicia en el trato profesor", "Genero estudiantes|Mujer", "Genero estudiantes| Otro", "Percepción meritocratica apoderados x sentido de justicia en las notas")
)
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
# Cargar librerías
pacman::p_load(dplyr, #Manipulacion de datos
stargazer, #Tablas
sjmisc, # Tablas
summarytools, # Tablas
kableExtra, #Tablas
sjPlot, #Tablas y gráficos
corrplot, # Correlaciones
sessioninfo, #  Información de la sesión de trabajo
ggplot2, # Graficos
sjlabelled, # Etiquetas
ordinal, # Modelos ordinales,
mixor, # Modelos ordinales
lme4, # Modelos mixtos,
lavaan, # CFA
texreg, # Tablas modelos
reghelper # ICC
)
# Cargar datos
load(file = "../input/data/ap_est.RData") # Base conjunta
# Orden para modelos ordinales (mixor package)
ap_est_rbd<-ap_est[order(ap_est$rbd_est),]
# Remover etiquetas para rende
ap_est <- sjlabelled::remove_all_labels(ap_est)
sjPlot::view_df(ap_est, show.type = T, show.prc = T, show.na = T)
# Plot Likert: perc. trabajo duro apoderados y estudiantes
baselik<- ap_est %>% select(perc_trabajo_duro_est,perc_trabajo_duro_ap)
# short var labels
items <- c("Estudiante", "Apoderados")
# cambiar orden para la leyenda
labels= c("Nada Importante", "Poco Importante", "Importante", "Muy Importante")  ### E
#save
png("../output/images/Plot-lik-trabajoduro.png", width = 700, height = 350)
sjPlot::plot_likert(baselik,
axis.labels   = items,
legend.labels = labels,
legend.pos = "bottom",
#cat.neutral   = , # identifica a indiferentes
geom.colors   = c("#9ECAE1", "#6BAED6", "#4292C6",
"#2171B5"), # colorbrewer2.org
sort.frq      = "neg.asc", # sort descending)
title         = "Actualmente en Chile, para surgir en la vida   ¿Cuán importante es el trabajo duro?",
intercept.line.color = "white", # vertical middle
expand.grid   = F, # no inner margins in plot
show.n        = FALSE, # hide N's in axis labels
grid.range    = 1.8,
geom.size = 0.6, values = "sum.outside")
dev.off()
# Plot Likert: perc. esfuerzo apoderados y estudiantes
baselik<- ap_est %>% select(perc_esfuerzo_est,perc_esfuerzo_ap)
# short var labels
items <- c("Percepcion esfuerzo estudiantes", "Percepcion esfuerzo apoderados")
# cambiar orden para la leyenda
labels= c("Muy en desacuerdo", "En desacuerdo", "De acuerdo", "Muy de acuerdo")  ### E
# save
#png("../output/images/Plot-lik-esfuerzo.png", width = 750, height = 300)
sjPlot::plot_likert(baselik,
axis.labels   = items,
legend.labels = labels,
legend.pos = "bottom",
#cat.neutral   = , # identifica a indiferentes
geom.colors   = c("#9ECAE1", "#6BAED6", "#4292C6",
"#2171B5"), # colorbrewer2.org
sort.frq      = "neg.asc", # sort descending)
title         = "Percepción de meritocracia Apoderados e hijos",
intercept.line.color = "white", # vertical middle
expand.grid   = F, # no inner margins in plot
show.n        = FALSE, # hide N's in axis labels
grid.range    = 1.8,
geom.size = 0.6, values = "sum.outside")
#dev.off()
select(ap_est, sj_indirect_ln, sj_indirect_noln) %>% summarytools::descr()
# Profundización sentido de justicia
plot_grpfrq(ap_est$quintiles_ingresos_pc_factor, ap_est$sj_indirect_ln,
type = "box")
# Profundización sentido de justicia
plot_grpfrq(ap_est$sj_indirect_ln, ap_est$quintiles_ingresos_pc_factor,
type = "box")
ap_est %>% # se especifica la base de datos
select(sj_indirect_ln,quintiles_ingresos_pc_factor) %>% # se seleccionan las variables
dplyr::group_by(Quintiles=sjlabelled::as_label(quintiles_ingresos_pc_factor)) %>% # se agrupan por la variable categórica y se usan sus etiquetas con as_label
dplyr::summarise(Obs.=n(),Promedio=mean(sj_indirect_ln),SD=sd(sj_indirect_ln)) %>% # se agregan las operaciones a presentar en la tabla
kable(, format = "markdown") # se genera la tabla
sjt.xtab(ap_est$quintiles_ingresos_pc_factor, ap_est$sj_direct_factor,
show.col.prc=TRUE,
show.summary=FALSE
)
sjt.xtab(ap_est$pos_pol_factor_est, ap_est$sj_direct_factor,
show.col.prc=TRUE,
show.summary=FALSE
)
sjt.xtab(ap_est$prom_obt, ap_est$prom_mer,
show.col.prc=TRUE,
show.summary=FALSE
)
## Promedio percepcion meritocratica
## x Genero estudiantes
ap_est %>% # se especifica la base de datos
select(prom_percmer_est,genero_factor_est) %>% # se seleccionan las variables
dplyr::group_by(Generos=sjlabelled::as_label(genero_factor_est)) %>% # se agrupan por la variable categórica y se usan sus etiquetas con as_label
dplyr::summarise(Obs.=n(),Promedio=mean(prom_percmer_est),SD=sd(prom_percmer_est)) %>% # se agregan las operaciones a presentar en la tabla
kable(, format = "markdown") # se genera la tabla
## Promedio percepcion meritocratica
## x Genero estudiantes
table1::label(ap_est$prom_percmer_est) <- "Percepcion meritocratica estudiantes"
# Cargar librerías
pacman::p_load(dplyr, #Manipulacion de datos
stargazer, #Tablas
sjmisc, # Tablas
summarytools, # Tablas
kableExtra, #Tablas
sjPlot, #Tablas y gráficos
corrplot, # Correlaciones
sessioninfo, #  Información de la sesión de trabajo
ggplot2, # Graficos
sjlabelled, # Etiquetas
ordinal, # Modelos ordinales,
mixor, # Modelos ordinales
lme4, # Modelos mixtos,
lavaan, # CFA
texreg, # Tablas modelos
reghelper, # ICC,
table1 #Tabla bonita
)
# Cargar datos
load(file = "../input/data/ap_est.RData") # Base conjunta
# Orden para modelos ordinales (mixor package)
ap_est_rbd<-ap_est[order(ap_est$rbd_est),]
# Remover etiquetas para rende
ap_est <- sjlabelled::remove_all_labels(ap_est)
## Promedio percepcion meritocratica
## x Genero estudiantes
table1::label(ap_est$prom_percmer_est) <- "Percepcion meritocratica estudiantes"
table1::label(ap_est$prom_percmer_ap) <- "Percepcion meritocratica apoderados"
table1::label(gapminder$sj_indirect_ln) <- "Sentido de justicia indirecto"
## Promedio percepcion meritocratica
## x Genero estudiantes
table1::label(ap_est$prom_percmer_est) <- "Percepcion meritocratica estudiantes"
table1::label(ap_est$prom_percmer_ap) <- "Percepcion meritocratica apoderados"
table1::label(ap_est$sj_indirect_ln) <- "Sentido de justicia indirecto"
table1::table1(~prom_percmer_est + prom_percmer_ap + sj_indirect_ln | genero_factor_est, data = ap_est)
View(ap_est)
View(ap_est)
View(ap_est)
View(ap_est)
sjt.xtab(ap_est$quintiles_ingresos_pc_factor, ap_est$sj_direct_factor,
show.col.prc=TRUE,
show.summary=FALSE
)
# Sentido de justicia directo x dependencia administrativa
sjt.xtab(ap_est$sj_direct_factor, ap_est$quintiles_ingresos_pc_factor,
show.col.prc=TRUE,
show.summary=TRUE
)
# Sentido de justicia directo x genero estudiante
sjt.xtab(ap_est$sj_direct_factor, ap_est$genero_factor_est,
show.col.prc=TRUE,
show.summary=FALSE
)
